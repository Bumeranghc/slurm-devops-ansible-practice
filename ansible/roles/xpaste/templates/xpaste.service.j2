[Unit]
Description=XPASTE
Documentation=https://slurm.io
After=network.target

[Service]
WorkingDirectory=/tmp/xpaste
User=root
ExecStart=/bin/bash -lc "source /etc/profile.d/rvm.sh; SECRET_KEY_BASE=secretstring RAILS_ENV=production RAILS_LOG_TO_STDOUT=1 DB_HOST=127.0.0.1 DB_PORT=5432 DB_NAME=xpastedb DB_USER=xpasteuser DB_PASSWORD=xpastepassword bundle exec rake db:migrate && bundle exec puma -b unix:/var/run/puma.sock -e $RAILS_ENV config.ru"
ExecReload=/bin/kill -USR1 $MAINPID
ExecStop=/bin/kill -TSTP $MAINPID
Restart=always
Type=simple

[Install]
WantedBy=multi-user.targetexit
